@model UI.Models.GamingGroup.GamingGroupViewModel
@using UI.HtmlHelpers
@{
    ViewBag.Title = Model.Name;
    Layout = MVC.Shared.Views._BaseLayout;
}

<h2>
    <span class="editable-title" id="gamingGroupTitle" title="Click to rename the gaming group">@Model.Name</span>
    <a href="#" onclick="clickElement('gamingGroupTitle')" title="UpdateGamingGroupName">
        <span class="fa fa-pencil"></span>
    </a>
</h2>

<hr />

<a name="@ViewBag.PlayerSectionAnchorText"></a>

<div class="row">
	@Html.Partial(MVC.GamingGroup.Views._GamingGroupPublicDetailsPartial, Model.GamingGroupEditViewModel)
</div>

<div class="row">
    @{
        Html.RenderPartial("~/Views/Player/_PlayersPartial.cshtml", Model.Players, new ViewDataDictionary {{"canEdit", true}});
    }
</div>

<a name="@ViewBag.GameDefinitionSectionAnchorText"></a>
<div class="row">
    @Html.Partial("~/Views/GameDefinition/_GameDefinitionsPartial.cshtml", Model.GameDefinitionSummaries, new ViewDataDictionary { { "canEdit", true } })
</div>


<a name="@ViewBag.RecentGamesSectionAnchorText"></a>
<div class="row">
   @Html.Partial("~/Views/PlayedGame/_PlayedGamesPartial.cshtml", Model.PlayedGames, new ViewDataDictionary { { "canEdit", true }, { "gamingGroupId", @Model.Id} })
</div>

@section Scripts {
    <script type="text/javascript">
        //Creation
        $(document).ready(function () {
            var players = new window.Views.Player.Players();
            players.init();

            var createOrUpdatePlayer = new window.Views.Player.CreateOrUpdate();
            createOrUpdatePlayer.init($.proxy(players.onPlayerSaved, players));

            var gameDefinition = new window.Views.GameDefinition.CreateGameDefinitionPartial();
            gameDefinition.init();

            var gameDefinitions = new window.Views.GameDefinition.GameDefinitions();
            gameDefinitions.init();
            gameDefinition.onDefinitionCreated = $.proxy(gameDefinitions.onGameCreated, gameDefinitions);

            var gamingGroupView = new Views.GamingGroup.GamingGroupView();
            var googleAnalyticsObject = new window.Views.Shared.GoogleAnalytics();
            gamingGroupView.init(googleAnalyticsObject);

            var recordexceldownload = new window.Views._PlayedGamesPartial.EventTracking();
            recordexceldownload.init(googleAnalyticsObject);
        });
    </script>
}
